"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.CorsManager = void 0;
class CorsManager {
    /**
     *
     * @returns {keepExecution: this is not}
     */
    static ManageCors(data, manageCorsOptions) {
        const { allowOrigins = { "*": true }, maxAge, allowHeaders = ["X-PINGOTHER", "Content-Type", "Cookie", "Set-Cookie"], allowMethods = ["POST", "GET", "OPTIONS"] } = manageCorsOptions;
        if (!data.origin) {
            return { success: true, keepExecution: true };
        }
        if (allowOrigins && allowOrigins["*"] !== true && allowOrigins[data.origin[0]] !== true) {
            console.log("Http header Origin Not allowed");
            return { success: false, statusCode: 403, message: "Forbidden" };
        }
        console.log("adding CORS headers");
        const headers = {};
        headers["Access-Control-Allow-Origin"] = data.origin[0] || "*";
        headers["Access-Control-Allow-Credentials"] = "true";
        if (data.method == "OPTIONS") {
            console.log("adding CORS OPTIONS headers");
            headers["Access-Control-Allow-Methods"] = allowMethods.join(",");
            headers["Access-Control-Allow-Headers"] = allowHeaders.join(",");
            if (maxAge) {
                headers["Access-Control-Max-Age"] = maxAge;
            }
            headers["Vary"] = "Accept-Encoding, Origin";
            return { success: true, keepExecution: false, headers };
        }
        return { success: true, keepExecution: true, headers };
    }
}
exports.CorsManager = CorsManager;
//# sourceMappingURL=corsHelper.js.map