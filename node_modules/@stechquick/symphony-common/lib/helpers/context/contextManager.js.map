{"version":3,"file":"contextManager.js","sourceRoot":"","sources":["../../../src/helpers/context/contextManager.ts"],"names":[],"mappings":";;;AAEA,MAAa,cAAc;IAEvB;QADQ,iBAAY,GAAoD,EAAE,CAAC;IAG3E,CAAC;IAED;;;OAGG;IACI,YAAY,CAAC,IAAkB,EAAE,UAA+B,EAAC,QAAQ,EAAC,KAAK,EAAC;QACnF,IAAI,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QACvD,IAAI,CAAC,YAAY,IAAI,OAAO,CAAC,QAAQ,EAAE;YACnC,YAAY,GAAG,EAAE,CAAC;YAClB,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,WAAW,CAAC,GAAG,YAAY,CAAC;SACtD;QAED,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC5B,CAAC;IAEM,WAAW,CAAuC,eAAuB,EAAE,gBAAuC;QACrH,IAAI,WAAW,GAAG,IAAI,CAAC,aAAa,CAAkB,eAAe,CAAC,CAAC;QACvE,IAAI,CAAC,WAAW,EAAE;YACd,WAAW,GAAG,gBAAgB,EAAE,CAAC;YACjC,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;SAClC;QACD,OAAO,WAAW,CAAC;IACvB,CAAC;IAED;;OAEG;IACI,OAAO,CAAuC,eAAuB;QACxE,OAAO,IAAI,CAAC,aAAa,CAAkB,eAAe,CAAC,IAAI,IAAkC,CAAC;QAClG,sBAAsB;QACtB,4EAA4E;QAC5E,uBAAuB;QACvB,iDAAiD;QACjD,IAAI;QACJ,oFAAoF;IACxF,CAAC;IACD;;OAEG;IACI,aAAa,CAAuC,eAAuB;QAC9E,MAAM,YAAY,GAAG,IAAI,CAAC,YAAY,CAAkB,eAAe,CAAC,CAAC;QACzE,IAAI,CAAC,YAAY,EAAE;YACf,OAAO,SAAS,CAAC;SACpB;QACD,OAAO,YAAY,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,kBAAkB;IACpE,CAAC;IAEM,YAAY,CAAuC,eAAuB;QAC7E,OAAQ,IAAI,CAAC,YAAY,CAAC,eAAe,CAA4B,IAAI,IAAI,CAAC;IAClF,CAAC;IAEM,cAAc,CAAC,eAAuB;QACzC,OAAO,IAAI,CAAC,YAAY,CAAC,eAAe,CAAC,CAAC;IAC9C,CAAC;IAEM,SAAS,CAAC,CAAe;QAC5B,MAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC;QACnD,IAAI,CAAC,SAAS,EAAE;YACZ,OAAO;SACV;QACD,MAAM,SAAS,GAAG,SAAS,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QACvC,SAAS,CAAC,MAAM,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;IACnC,CAAC;IAED;;;OAGG;IACI,KAAK,CAAC,MAAsB;QAC/B,MAAM,WAAW,GAAG,IAAI,cAAc,EAAgB,CAAC;QACvD,MAAM,IAAI,GAAG,MAAM,aAAN,MAAM,cAAN,MAAM,GAAI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QACtD,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,CAAC,WAAW,CAAC,YAAY,CAAC,UAAU,CAAC,GAAG,IAAI,CAAC,YAAY,CAAC,UAAU,CAAE,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;QACpH,OAAO,WAAW,CAAC;IACvB,CAAC;IAED;;OAEG;IACI,OAAO;QACV,OAAO,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;IAC1C,CAAC;CACJ;AAtFD,wCAsFC","sourcesContent":["import { IContextItem } from \"./IContextItem\";\n\nexport class ContextManager<TContextItem extends IContextItem> {\n    private contextItems: Record<string, Array<TContextItem> | undefined> = {};\n    constructor() {\n        \n    }\n\n    /**\n     * Register item to context\n     * @param item item to register\n     */\n    public RegisterItem(item: TContextItem, options: {override?:boolean} = {override:false}   ) {\n        let contextGroup = this.contextItems[item.contextName];\n        if (!contextGroup || options.override) {\n            contextGroup = [];\n            this.contextItems[item.contextName] = contextGroup;\n        }\n\n        contextGroup.push(item);\n    }\n\n    public GetOrCreate<contextItemType extends TContextItem>(contextItemName: string, contextCreatorCb: () => contextItemType): contextItemType{\n        let contextItem = this.GetItemSingle<contextItemType>(contextItemName);\n        if (!contextItem) {\n            contextItem = contextCreatorCb();\n            this.RegisterItem(contextItem);\n        }\n        return contextItem;\n    }\n\n    /**\n     * @deprecated use -> GetItemSingle. Careful -> returns undefined. Use ! if must exist\n     */\n    public GetItem<contextItemType extends TContextItem>(contextItemName: string): contextItemType {\n        return this.GetItemSingle<contextItemType>(contextItemName) || null as unknown as contextItemType;\n        //Delete on 22.02.2021\n        // const contextGroup = this.GetItemGroup<contextItemType>(contextItemName);\n        // if (!contextGroup) {\n        //     return null as unknown as contextItemType;\n        // }\n        // return <contextItemType>contextGroup[contextGroup.length - 1]; //contextItem.name\n    }\n    /**\n     * Gets last Item. Use ! if it must exist.\n     */\n    public GetItemSingle<contextItemType extends TContextItem>(contextItemName: string): contextItemType | undefined {\n        const contextGroup = this.GetItemGroup<contextItemType>(contextItemName);\n        if (!contextGroup) {\n            return undefined;\n        }\n        return contextGroup[contextGroup.length - 1]; //contextItem.name\n    }\n\n    public GetItemGroup<contextItemType extends TContextItem>(contextItemName: string): Array<contextItemType> | null {\n        return (this.contextItems[contextItemName] as Array<contextItemType>) || null;\n    }\n\n    public ClearItemGroup(contextItemName: string) {\n        delete this.contextItems[contextItemName];\n    }\n\n    public ClearItem(c: TContextItem) {\n        const itemGroup = this.GetItemGroup(c.contextName);\n        if (!itemGroup) {\n            return;\n        }\n        const itemIndex = itemGroup.indexOf(c);\n        itemGroup.splice(itemIndex, 1);\n    }\n\n    /**\n     * Shallow copy of self\n     * @param fields if specified, only puts those fields in the clone\n     */\n    public Clone(fields?: Array<string>): ContextManager<TContextItem> {\n        const contextCopy = new ContextManager<TContextItem>();\n        const keys = fields ?? Object.keys(this.contextItems);\n        keys.forEach(contextKey => contextCopy.contextItems[contextKey] = this.contextItems[contextKey]!.map(item => item));\n        return contextCopy;\n    }\n\n    /**\n     * Get Contexts registered context item keys\n     */\n    public GetKeys(){\n        return Object.keys(this.contextItems);\n    }\n}\n"]}