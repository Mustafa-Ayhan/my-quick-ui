{"version":3,"file":"pipeline.js","sourceRoot":"","sources":["../../src/pipeline.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKA;IAAA;IAYA,CAAC;IAXgB,0BAAO,GAApB,UAAqB,cAAmC,EAAE,cAA+B,EAAE,SAAsB,EAAE,OAAmC;;;;;;4BAC3F,4BAAM,OAAO,aAAP,OAAO,6BAAP,OAAO,CAAE,mBAAmB,EAAC,cAAc,CAAC,MAAM,oDAAI,cAAc,CAAC,OAAO,CAAC,WAAW,EAAE,SAAS,EAAE,cAAc,IAAC;;wBAA7K,QAAQ,GAA2C,SAA0H;wBACjL,IAAI,QAAQ,EAAE;4BACV,cAAc,GAAG,QAAQ,CAAC;4BAC1B,OAAO,CAAC,WAAW,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,OAAO,EAAE,EAAE,EAAE,WAAW,EAAE,cAAM,OAAA,6BAA2B,QAAS,CAAC,MAAM,cAAW,GAAG,IAAI,CAAC,SAAS,CAAC,CAAA,QAAQ,aAAR,QAAQ,uBAAR,QAAQ,CAAE,OAAO,KAAI,EAAE,CAAC,EAAhG,CAAgG,EAAE,CAAC,CAAC;yBAC3K;6BAAM;4BACH,OAAO,CAAC,WAAW,CAAC,EAAC,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE,EAAE,EAAE,WAAW,EAAE,cAAM,OAAA,QAAM,cAAc,CAAC,MAAQ,EAA7B,CAA6B,EAAC,CAAC,CAAC;yBACxG;wBACD,cAAc,CAAC,QAAQ,CAAC,YAAY,CAAC,SAAS,CAAC,cAAc,CAAC,MAAM,EAAE,cAAc,CAAC,OAAO,CAAC,CAAC;wBAC9F,cAAc,CAAC,QAAQ,CAAC,YAAY,CAAC,GAAG,CAAC,cAAc,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;;;;;KAC7E;IACL,eAAC;AAAD,CAAC,AAZD,IAYC;AAZY,4BAAQ","sourcesContent":["import { IFileHandleResponse } from \"./fileHandler\";\nimport { IServiceOptions } from \"./IService\";\nimport { INanoServerOptionsInternal } from \"./NanoServer\";\nimport { IParsedPath } from \"./RouteParser\";\n\nexport class Pipeline{\n    public async Respond(handleResponse: IFileHandleResponse, serviceOptions: IServiceOptions, parsedUrl: IParsedPath, options: INanoServerOptionsInternal){\n        let redirect: IFileHandleResponse | undefined | null = await options?.statusCodeRedirects[handleResponse.status]?.(serviceOptions.request.httpRequest, parsedUrl, handleResponse);\n        if (redirect) {\n            handleResponse = redirect;\n            options.logOverride({ level: \"log\", message: \"\", messageFunc: () => `custom redirect status: ${redirect!.status} headers:` + JSON.stringify(redirect?.headers || {}) });\n        } else {\n            options.logOverride({level: \"debug\", message: \"\", messageFunc: () => `<- ${handleResponse.status}`});\n        }\n        serviceOptions.response.httpResponse.writeHead(handleResponse.status, handleResponse.headers);\n        serviceOptions.response.httpResponse.end(handleResponse.content, \"utf-8\");\n    }\n}"]}