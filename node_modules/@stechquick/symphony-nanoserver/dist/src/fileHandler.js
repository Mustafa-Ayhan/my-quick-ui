"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.FileHandler = void 0;
var path_1 = __importDefault(require("path"));
var fs_1 = __importDefault(require("fs"));
var FileHandler = /** @class */ (function () {
    function FileHandler() {
    }
    FileHandler.prototype.handleFileRequest = function (basePath, parsedUrl) {
        var filePath = path_1.default.resolve(path_1.default.join(basePath, parsedUrl.dir, parsedUrl.base));
        var fileDetailError = "basePath: " + basePath + " dir:" + parsedUrl.dir + " fileName:" + parsedUrl.base + " ";
        if (!fs_1.default.existsSync(filePath)) {
            var fnf = "File Not Found";
            console.error(fnf + ": " + filePath, fileDetailError);
            return { status: 404, content: fnf };
        }
        var contentType = this.getContentType(parsedUrl.ext);
        try {
            var file = fs_1.default.readFileSync(filePath);
            return { status: 200, headers: { "Content-Type": contentType, "Content-Length": file.length.toString() }, content: file };
        }
        catch (ex) {
            console.error("File read error: " + filePath, ex, fileDetailError);
            return { status: 500, content: "Sorry, check error: " + ex.code };
        }
    };
    FileHandler.prototype.getContentType = function (extension) {
        var textPlain = "text/plain";
        var mimeTypes = {
            '.html': 'text/html',
            '.js': 'application/javascript; charset=UTF-8',
            '.css': 'text/css',
            '.json': 'application/json',
            '.png': 'image/png',
            '.jpg': 'image/jpg',
            '.gif': 'image/gif',
            '.tiff': 'image/tiff',
            '.wav': 'audio/wav',
            '.mp4': 'video/mp4',
            '.woff': 'application/font-woff',
            '.ttf': 'application/font-ttf',
            '.eot': 'application/vnd.ms-fontobject',
            '.otf': 'application/font-otf',
            '.svg': 'image/svg+xml',
            ".dll": "application/octet-stream",
            ".txt": textPlain
        };
        var contentType = mimeTypes[extension] || textPlain;
        return contentType;
    };
    return FileHandler;
}());
exports.FileHandler = FileHandler;
//# sourceMappingURL=fileHandler.js.map