"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.FnPredeploy = void 0;
const predeployCommon_1 = require("../predeployCommon");
const pathFinder_1 = require("../../../pathFinder");
const log_1 = require("@stechquick/symphony-common/lib/log");
const chalk_1 = require("../../../helpers/chalk");
const npmHelper_1 = require("../../../helpers/npmHelper");
class FnPredeploy {
    static async execute(replaceWords) {
        log_1.Logger.log({ message: chalk_1.Chalk.create("green.bold", "Predeploy starting...") });
        const options = {
            folder: "./functions",
            itemEndsWith: "func.yaml",
            iterator: (targetPath, funcName) => new predeployCommon_1.PredeployCommon().preDeployReplaceCopier(targetPath, funcName, replaceWords, this.copyList)
        };
        npmHelper_1.NpmHelper.install({ folderName: "./" });
        new predeployCommon_1.PredeployCommon().forEachFolderWithItem(options);
        log_1.Logger.log({ message: chalk_1.Chalk.create("green.bold", "Predeploy finished successfully...") });
    }
}
exports.FnPredeploy = FnPredeploy;
FnPredeploy.copyList = [
    { path: "package.json" },
    { path: "tsconfig.json" },
    { path: "node_modules" },
    { path: pathFinder_1.PathFinder.RootPath("/templates/fnPredeploy/Dockerfile"), needParamReplace: true, sourceFullPath: true },
    { path: pathFinder_1.PathFinder.RootPath("/templates/fnPredeploy/.npmrc"), needParamReplace: true, sourceFullPath: true },
    { path: pathFinder_1.PathFinder.RootPath("/templates/init/{{AppName}}/sym-engine"), needParamReplace: false, sourceFullPath: true },
];
