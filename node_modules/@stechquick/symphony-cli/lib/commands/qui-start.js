"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const command_1 = require("@oclif/command");
const child_process_1 = require("child_process");
const quiBuilder_1 = require("../helpers/ui/quiBuilder");
const chalk_1 = require("../helpers/chalk");
const log_1 = require("@stechquick/symphony-common/lib/log");
const fs_1 = tslib_1.__importDefault(require("fs"));
class StartUI extends command_1.Command {
    async run() {
        log_1.Logger.log({ message: chalk_1.Chalk.create("green.bold", "Quick starting. Please wait..."), timeFormat: "datetime" });
        const { flags } = this.parse(StartUI);
        if (flags.build) {
            await new quiBuilder_1.FolderCopier().Execute();
        }
        const args = ['./dist/server/server.js']; // try server adaptor first, then fallback to nanoserver
        if (!fs_1.default.existsSync(args[0])) {
            args[0] = './dist/server/nanoServer.js';
        }
        child_process_1.spawnSync("node", args, { stdio: 'inherit' });
        log_1.Logger.log({ message: chalk_1.Chalk.create("green.bold", "Quick started successfully."), timeFormat: "datetime" });
    }
}
exports.default = StartUI;
StartUI.description = 'Plateau-QUI command for start your Quick ui project with/without build';
StartUI.examples = [`$ symphony-cli qui-start -b`];
StartUI.flags = {
    build: command_1.flags.boolean({ char: 'b', description: 'for build' }),
};
