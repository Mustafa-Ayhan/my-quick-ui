{"version":3,"file":"PlateauMessaging.js","sourceRoot":"","sources":["../../src/protocols/PlateauMessaging.ts"],"names":[],"mappings":";;;AACA,kEAA+E;AAcxD,kGAdd,qCAAiB,OAcc;AA4rBxC;IAAA;IAKA,CAAC;IAJiB,uCAAsB,GAApC,UAAqC,YAAoB;QACrD,IAAM,GAAG,GAAG,IAAI,qCAAiB,CAAW,YAAY,CAAC,CAAC;QAC1D,OAAO,GAAG,CAAC;IACf,CAAC;IACL,uBAAC;AAAD,CAAC,AALD,IAKC;AALY,4CAAgB","sourcesContent":["import { ISettings, ISettingsIAM } from \"../quick/IPlateauUI\";\nimport { FrameCommunicator, MessageTypes } from \"../helpers/frameCommunicator\";\nimport { ISocketPackage } from \"../helpers/socket/structuredSocket\";\nimport { IExternalQJsonRetriever } from \"../quick/IExternalQJsonRetriever\";\nimport { IModelState } from \"../quick/IModelState\";\nimport { IEditorVisibility } from \"../quick/IEditorVisibility\";\nimport { INamedCompModel, INamedCompModelOnly } from \"../quick/INamedCompModel\";\nimport { ApplicationObjectType, GeneratePageType, IApplication, IModelInfo, IModule, IPimQJsonOptions, ModelObjectType, ModelType, ModuleObjectType, ObjectID } from \"../qCloudTemp/quickCloud\";\nimport { IMsgType } from \"../logster/IMsgType\";\nimport { IBaseErrorMsg, IBaseMsg } from \"../logster/IMsg\";\nimport { loglevel } from \"../logster/ILogLevel\";\nimport { IConfig } from \"../quick/IConfig\";\nimport { ICodeAssistantResponse } from \"../qCloudTemp/AIService/codeAssistant\";\nimport { IContainerModel } from \"../quick/IContainerModel\";\n\nexport { MessageTypes, FrameCommunicator, ISocketPackage };\nexport type PModules = {\n    Quick: {\n        getModel: {\n            type: \"getModel\";\n            unformatQjson?: boolean;\n        };\n        getModelResponse: {\n            type: \"getModelResponse\";\n            content: string;\n            fileName: string;\n            state?: IModelState;\n            ownerType?: ModelType\n            ownerItem?: ObjectID\n            errorStatus?: boolean\n        };\n        setModel: {\n            type: \"setModel\";\n            content: string,\n            fileName: string,\n            settings?: {\n                \"settings.yaml\"?: string,\n                \"localProxy.yaml\"?: string,\n                \"pipeline.qjson\"?: string,\n                \"containerServices.js\"?: string,\n                \"componentList.js\"?: string,\n                \"alert.qjson\"?: string,\n                \"loading.qjson\"?: string,\n                \"main.css\"?: string,\n                \"globalLocalization.qjson\"?: string,\n                \"themeSettings.js\"?: string,\n                \"assetList.yaml\"?: string,\n                \"appSettings\"?: string,\n                fontPath?: Array<{ ID: string, fontName: string, italic?: boolean, fontWeights:  Array<string>, combinedFont: string }>\n            },\n            container?: IContainerModel,\n            state?: IModelState,\n            ownerType?: ModelType,\n            ownerItem?: ObjectID,\n            ID?: ObjectID,\n            qjsonVersion?: number,\n            usageType?: string\n        };\n        setModelResponse: {\n            type: \"setModelResponse\";\n        };\n        setEditorVisibility: {\n            type: \"setEditorVisibility\";\n            options?: IEditorVisibility,\n        },\n        changeCheckOutStatus: {\n            type: \"changeCheckOutStatus\",\n            checkedOut: boolean;\n        };\n        showNotification: {\n            type: \"showNotification\";\n            notificationOptions: {\n                type: \"warning\" | \"error\" | \"success\" | \"info\";\n                text: string;\n            }\n        };\n        generatePageEntityModel: {\n            type: \"generatePageEntityModel\";\n            params: { type: GeneratePageType, model: any, fileName: string, isProcess: boolean };\n        };\n        IAmReady: {\n            type: \"IAmReady\";\n        };\n        IAmReadyResponse: {\n            type: \"IAmReadyResponse\";\n            editorButtons: {\n                file?: boolean,\n                edit?: boolean,\n                addStyle?: boolean,\n                settings?: boolean,\n                help?: boolean,\n                wsUrl?: string,\n                createNamedComponent?: boolean,\n                pageWizard?: boolean,\n                imageWizard?: boolean\n            };\n            qjsonHandling: IExternalQJsonRetriever[\"qjsonHandling\"];\n            flow?: boolean;\n            sw?: boolean;\n            editorConfigs?: {\n                quick: {\n                    serviceWorkerScope: string;\n                }\n            };\n        };\n        letsGo: {\n            type: \"letsGo\",\n        };\n        letsGoResponse: {\n            type: \"letsGoResponse\",\n        };\n        openDocs: {\n            type: \"openDocs\";\n        };\n        openDocsResponse: {\n            type: \"openDocsResponse\";\n            fileName: string;\n        };\n        setOptions: {\n            type: \"setOptions\";\n            flow?: boolean;\n            workflow?: boolean;\n        }\n        getQuickComp: {\n            type: \"getQuickComp\";\n            qjsonPath: string;\n        };\n        getImage: {\n            type: \"getImage\";\n            imagePath: string;\n        };\n        getQuickCompResponse: {\n            type: \"getQuickCompResponse\";\n            qjson: string;\n        };\n        getImageResponse: {\n            type: \"getImageResponse\";\n            image: string;\n        };\n        getResource: {\n            type: \"getResource\";\n            resourceId: string;\n        };\n        getResourceResponse: {\n            type: \"getResourceResponse\";\n            resource: string;\n        };\n        setQuickComps: {\n            type: \"setQuickComps\";\n            params: Array<{\n                name: string,\n                id?: string,\n                qJsonOptions: IPimQJsonOptions,\n                qJsonPath?: string;\n            }>;\n            removeOlds?: boolean;\n        };\n        setNamedCompModel: {\n            type: \"setNamedCompModel\";\n            compPath?: any,\n            pim: any,\n            files: any,\n            compName: any,\n            state: any,\n        };\n        addOrUpdateNamedComp: {\n            type: \"addOrUpdateNamedComp\";\n            compName: string;\n            compModel: INamedCompModel;\n            compPath?: string;\n        };\n        addOrUpdateNamedCompResponse: {\n            type: \"addOrUpdateNamedCompResponse\";\n            success: boolean;\n            compPath?: string;\n            message?: string;\n        };\n        getNamedComp: {\n            type: \"getNamedComp\";\n            compPath: string;\n        };\n        getNamedCompResponse: {\n            type: \"getNamedCompResponse\";\n            compModel: INamedCompModel;\n        };\n        findUnselectItem: {\n            type: \"findUnselectItem\";\n            isItemUnselected: boolean;\n        };\n        setNamedCompList: {\n            type: \"setNamedCompList\";\n            compModelList: Array<INamedCompModelOnly>;\n        };\n        setProperties: {\n            type: \"setProperties\";\n            params: {\n                cssStyle?: string, hostFunctions?: string\n            };\n        };\n        openPageWizard: {\n            type: \"openPageWizard\";\n        };\n        openImageWizard: {\n            type: \"openImageWizard\";\n        };\n        openLottieWizard: {\n            type: \"openLottieWizard\";\n        };\n        openPageWizardResponse: {\n            type: \"openPageWizardResponse\";\n            qjsonPath: string;\n        };\n        openConstantWizard: {\n            type: \"openConstantWizard\";\n        };\n        openConstantWizardResponse: {\n            type: \"openConstantWizardResponse\";\n            constant: string;\n        };\n        openRunFunction: {\n            type: \"openRunFunction\";\n        };\n        openRunFunctionResponse: {\n            type: \"openRunFunctionResponse\";\n            flowId: string;\n            params: Record<string, any>;\n        };\n        openImageWizardResponse: {\n            type: \"openImageWizardResponse\";\n            imgList: { path: string, name: string };\n        };\n        openLottieWizardResponse: {\n            type: \"openLottieWizardResponse\";\n            lottieList: { path: string, name: string };\n        };\n        setImages: {\n            type: \"setImages\",\n            images: Array<{ ID: string, name: string }>\n        };\n        setLottie: {\n            type: \"setLottie\",\n            lottie: Array<{ ID: string, name: string }>\n        };\n        setFonts: {\n            type: \"setFonts\",\n            fonts: Array<{ ID: string, fontName: string, italic?: boolean, fontWeights:  Array<string>, combinedFont: string }>\n        };\n        setBlockComponentQjson: {\n            type: \"setBlockComponentQjson\",\n            qjsons: Array<{ ID: string, name: string }>\n        };\n        setQjson: {\n            type: \"setQjson\",\n            qjsons: Array<{ ID: string, name: string }>\n        };\n        updateModelName: {\n            type: \"updateModelName\",\n            oldName: string,\n            newName: string,\n            modelType: string\n        };\n        addComponentToScreen: {\n            type: \"addComponentToScreen\",\n            // modelID: ObjectID,\n            // componentType: \"basicComponent\" | \"quickComponent\",\n            // component: \"VProcessLayout\"\n        };\n        modifiedRequest: {\n            type: \"modifiedRequest\";\n            size: number;\n            qjson: string;\n        };\n        listUIModelsRequest: { // Delete on WorkFlow -> Main Merge\n            type: \"listUIModelsRequest\";\n        };\n        listUIModelsResponse: {// Delete on WorkFlow -> Main Merge\n            type: \"listUIModelsResponse\";\n            models: Array<{\n                qjsonPath: string;\n                name: string;\n            }>;\n        },\n        changeAsset: {\n            type: \"changeAsset\",\n            compName: string,\n            assetName: string,\n            assetList: string\n        },\n        editAsset: {\n            type: \"editAsset\",\n            assetName: string\n        };\n        addStyle: {\n            type: \"addStyle\";\n            id: string;\n            content?: string;\n        };\n        themeConfigChange: {\n             type: \"themeConfigChange\";\n             id: string;\n             content?: string;\n        }\n        deleteStyle: {\n            type: \"deleteStyle\";\n            id: string;\n        };\n        serviceWorkerRequestRequest: {\n            type: \"serviceWorkerRequestRequest\",\n            resourceId: string\n        };\n        serviceWorkerRequestResponse: {\n            type: \"serviceWorkerRequestResponse\",\n            resourceModel: string;\n            resourceId: string;\n            resourceType: string;\n        };\n        getAIResponsiveSuggestionsRequest: {\n            type: \"getAIResponsiveSuggestionsRequest\",\n            layoutModel: object, //TODO:AISuggestions change type \n            metrics: {\n                correlationid: string,\n                requestid: number,\n            }\n        }\n        getAIResponsiveSuggestionsResponse: {\n            type: \"getAIResponsiveSuggestionsResponse\",\n            suggestions: object, //TODO:AISuggestions change type \n            metrics?: {\n                correlationid?: string,\n                logid?: string\n            }\n        },\n        codeAssistantRequest: {\n            type: \"codeAssistantRequest\",\n            monacoEditorValue: string,\n            action: \"refactor\" | \"explain\",\n            metrics: {\n                correlationid: string,\n                requestSource: \"selection\" | \"fullEvent\"\n            }\n        }\n        getCodeAssistantResponse: {\n            type: \"getCodeAssistantResponse\",\n            response: ICodeAssistantResponse[\"refactorResponse\"] | ICodeAssistantResponse[\"explainResponse\"] | ICodeAssistantResponse[\"responseError\"];\n        },\n        createUIRequest: {\n            type: \"createUIRequest\",\n            imageData: any,\n            imageMetadata: {\n                fileName: string;\n                mimeType: string;\n                size: number;\n                lastModified: number;\n            }\n            metrics: {\n                correlationid: string,\n            }\n        }\n        createUIResponse: {\n            type: \"createUIResponse\",\n            response: string\n        },\n        publishHubsterEvent: {\n            type: \"publishHubsterEvent\",\n            item: IBaseMsg & IMsgType,\n            level: loglevel,\n            correlationid?: string\n        },\n        publishHubsterEventResponse: {\n            type: \"publishHubsterEventResponse\",\n            logid?: string\n        },\n        updateHubsterEvent: {\n            type: \"updateHubsterEvent\",\n            item: IBaseMsg & IMsgType,\n            level: loglevel,\n            correlationid?: string,\n            logid: string\n        },\n        setConfigValues: {\n            type: \"setConfigValues\";\n            configValues: IConfig[],\n        },\n        openApp: {\n            type: \"openApp\";\n            containerServIntelli?: string | \"\";\n            cssFiles?: [{\n                id: string,\n                content: string\n            }]\n        },\n        updateContServInt: {\n            type: \"updateContServInt\",\n            containerServIntelli?: string | \"\";\n        },\n        listModelsRequest: {\n            type: \"listModelsRequest\";\n            modelType: string;\n        },\n        listModelsResponse: {\n            type: \"listModelsResponse\";\n            models: Array<{\n                ID: string;\n                name: string;\n                modelType: ModelType;\n                path: string;\n            }>;\n        },\n        getModelBodyIORequest: {\n            type: \"getModelBodyIORequest\";\n            id: string;\n            bodyKey: string;\n        },\n        getModelBodyIOResponse: {\n            type: \"getModelBodyIOResponse\";\n            body: string;\n        },\n        studioModelEvent: {\n            type: \"studioModelEvent\";\n            types?: Array<{ ID: string, name: string, modelBody: string }>;\n            workflowDataInstances?: Array<{ ID: string, name: string }>;\n            masterPageCandidates?: Array<{ ID: string, name: string }>;\n            selectedPageID?: string;\n            flows?: Array<{ ID: string, name: string, path: string }>;\n            constants?: Array<{ ID: string, name: string, path: string }>;\n            container?: IContainerModel;\n\n        },\n        studioDataTypeModels: {\n            type: \"studioDataTypeModels\";\n            types?: Array<{ ID: string, name: string, modelBody: string }>;\n            workflowDataInstances?: Array<{ ID: string, name: string }>;\n            masterPageCandidates?: Array<{ ID: string, name: string }>;\n            flows?: Array<{ ID: string, name: string, path: string }>;\n            constants?: Array<{ ID: string, name: string, path: string }>;\n            container?: IContainerModel;\n        },\n        setContainerServIntelli: {\n            type: \"setContainerServIntelli\";\n            containerServIntelli?: string | \"\"\n        },\n        notificationRequest: {\n            type: \"notificationRequest\";\n            notifType: \"warning\" | \"error\" | \"success\" | \"info\";\n            text: string;\n            title?: string;\n            detail?: string;\n            timeout?: number;\n            /**\n             *  Whether or not the toast is paused when it is hovered by the mouse.\n             */\n            pauseOnHover?: boolean;\n            /**\n             *  Whether or not the toast is paused when the window loses focus.\n             */\n            pauseOnFocusLoss?: boolean;\n        },\n        pagePreviewEnabled: {\n            type: \"pagePreviewEnabled\"\n        },\n        findModelSearchResult: {\n            type: \"findModelSearchResult\";\n            result: {\n                compID: string,\n                isCustomEvent: boolean,\n                editorLang: \"QS\" | \"JS\" | \"TS\" | \"FL\" | \"GUI\",\n                name: string;\n                type: \"prop\" | \"event\";\n                code?: string;\n                column?: number;\n                lineNumber?: number;\n                searchValue?: string;\n                externalVisible?: boolean; \n                eventState?: \"NotSet\" | \"NewCustom\" | \"CustomNameChanged\";\n                compName?: string;\n                directiveName?: string;\n            },\n        },\n    },\n    ProcessManager: {\n        GetProcessListRequest: {\n            type: \"GetProcessListRequest\"\n        },\n        GetProcessListResponse: {\n            type: \"GetProcessListResponse\",\n            processList: Array<{\n                name: string,            // \"Kredi başvurusu yaratma onayı\"\n                id: string,              // 1\n                description: string,     // \"Yetkili kullanıcılar tarafından kontroller yapılarak kredi başvurusu yaratma onay/red süreci işletilir.\"\n                bpmnFile: string,        // \"createCreditApplicationConfirm.bpmn\"\n                created_at: string,      // \"2021-01-21 09:21:10\"\n                updated_at: string,      // \"2021-01-21 09:21:10\"\n                processTemplate: string, // \"singleApproval\"\n                pages: Array<{\n                    pageType: string,    // \"startPage\"  or  \"confirmPage1\"  or  \"confirmPage2\"  or  \"confirmPage3\" ...\n                    pageName: string,    // \"createCreditApplicationConfirmPage.qjson\"\n                    roles: Array<string> // [\"Musteri_Tanimlama\", \"BACK_OFFICE\"]\n                }>\n            }>\n        },\n        ListModules: {\n            type: \"ListModules\";\n            ownerProjects?: Array<ObjectID>;\n        },\n        ListModulesResponse: {\n            type: \"ListModulesResponse\";\n            modules: Array<IModule>;\n        },\n        ListModelsResponse: {\n            type: \"ListModelsResponse\",\n            models: IModelInfo[],\n        },\n        ListModels: {\n            type: \"ListModels\",\n            ownerItem: ObjectID,\n            modelType?: ModelType,\n        },\n        AddComponentToScreen: {\n            type: \"AddComponentToScreen\",\n            modelID: ObjectID,\n            componentType: \"basicComponent\" | \"quickComponent\",\n            component: \"VProcessLayout\"\n        },\n        AddComponentToScreenResponse: {\n            type: \"AddComponentToScreenResponse\",\n            success: boolean,\n            message: string\n        },\n        GetObjectInfo: {\n            type: \"GetObjectInfo\",\n            objectId: ObjectID,\n            objectType: ApplicationObjectType | ModuleObjectType | ModelObjectType\n        },\n        GetObjectInfoResponse: {\n            type: \"GetObjectInfoResponse\",\n            object: IApplication | IModule | IModelInfo\n        },\n        GetContent: {\n            type: \"GetContent\",\n            content: string,\n            fileName: string,\n            state?: IModelState,\n            ownerType?: ModelType,\n            ownerItem?: ObjectID,\n            ID?: ObjectID,\n        },\n        GetContentResponse: {\n            type: \"GetContentResponse\",\n            content: string,\n            fileName: string,\n            state?: IModelState,\n            ownerType?: ModelType,\n            ownerItem?: ObjectID,\n        },\n        SetContent: {\n            type: \"SetContent\",\n            content: string,\n            fileName: string,\n            state?: IModelState,\n            ownerType?: ModelType,\n            ownerItem?: ObjectID,\n            ID?: ObjectID,\n        },\n        SetContentResponse: {\n            type: \"SetContentResponse\",\n            content: string,\n            fileName: string,\n            state?: IModelState,\n            ownerType?: ModelType,\n            ownerItem?: ObjectID,\n        },\n        ContentChanged: {\n            type: \"ContentChanged\",\n            content: string,\n            fileName: string,\n            state?: IModelState,\n            ownerType?: ModelType,\n            ownerItem?: ObjectID,\n            ID?: ObjectID,\n            initiator?: string,\n        },\n        SetBpmnContent: {\n            type: \"SetBpmnContent\",\n            content: string,\n            fileName: string,\n            state?: IModelState,\n            ownerType?: ModelType,\n            ownerItem?: ObjectID,\n            ID?: ObjectID,\n            initiator?: string,\n        },\n        GetBpmnProcessVars: {\n            type: \"GetBpmnProcessVars\",\n            moduleName: string,\n            fileName: string,\n            ownerType?: ModelType,\n            ownerItem?: ObjectID,\n            ID?: ObjectID,\n            initiator?: string,\n        },\n        GetBpmnProcessVarsResponse: {\n            type: \"GetBpmnProcessVarsResponse\",\n            moduleName: string,\n            fileName: string,\n            ownerType?: ModelType,\n            ownerItem?: ObjectID,\n            ID?: ObjectID,\n            initiator?: string,\n            variables: Array<{\n                variableType: string,    // \"camunda:In\"  or  \"camunda:Out\"  or  \"camunda:InOut\"  ...\n                name: string    // \"createCreditApplicationConfirmPage.qjson\"\n            }>\n        },\n    },\n    EntityDesigner: {\n        getModel: {\n            type: \"getModel\";\n        };\n        getModelResponse: {\n            type: \"getModelResponse\";\n            state?: IModelState;\n            content: string;\n        };\n        setModel: {\n            type: \"setModel\";\n            content: string,\n            state?: IModelState,\n        };\n        setModelResponse: {\n            type: \"setModelResponse\";\n        };\n        changeCheckOutStatus: {\n            type: \"changeCheckOutStatus\",\n            checkedOut: boolean;\n        };\n        showNotification: {\n            type: \"showNotification\";\n            notificationOptions: {\n                type: \"warning\" | \"error\" | \"success\" | \"info\";\n                text: string;\n            }\n        };\n        IAmReady: {\n            type: \"IAmReady\";\n        };\n        IAmReadyResponse: {\n            type: \"IAmReadyResponse\";\n        };\n        modifiedRequest: {\n            type: \"modifiedRequest\";\n        };\n        modifiedAuthToken: {\n            type: \"modifiedAuthToken\";\n            token: string;\n        }\n    },\n    LivePreview: {\n        getLPID: {\n            type: \"getLPID\";\n        };\n        getLPIDResponse: {\n            type: \"getLPIDResponse\";\n            ID: string;\n        };\n        getLPPlateauUIOptions: {\n            type: \"getLPPlateauUIOptions\";\n        };\n        getLPPlateauUIOptionsResponse: {\n            type: \"getLPPlateauUIOptionsResponse\";\n            getQJsonUrlPrefix: string;\n            PlateauUIOptions: {\n                corsEnabled: boolean;\n                settings: ISettings;\n                iam: ISettingsIAM;\n                serviceWorker?: boolean;\n            };\n        };\n        lpServiceWorkerRequestRequest: {\n            type: \"lpServiceWorkerRequestRequest\",\n            resourceId: string\n        };\n        lpServiceWorkerRequestResponse: {\n            type: \"lpServiceWorkerRequestResponse\",\n            resourceModel: string;\n            resourceId: string;\n            resourceType: string;\n        };\n    },\n    LiveDashboard: {\n        postMessageToLiveDashboard: {\n            type: \"postMessageToLiveDashboard\";\n            businessKey: string;\n            processInstanceId: string;\n        };\n        getAdditionalHeadersRequest: {\n            type: \"getAdditionalHeadersRequest\";\n        },\n        getAdditionalHeadersResponse: {\n            type: \"getAdditionalHeadersResponse\";\n            headers: Record<string, any>;\n        };\n        triggerPipeline: {\n            type: \"triggerPipeline\";\n            eventName: string;\n            parameters: Record<string, any>;\n        };\n        destroyRequest: {\n            type: \"destroyRequest\";\n        };\n        destroyResponse: {\n            type: \"destroyResponse\";\n        };\n    }\n}\n\nexport class PlateauMessaging {\n    public static CreatePlateauMessaging(targetWindow: Window) {\n        const mes = new FrameCommunicator<PModules>(targetWindow);\n        return mes;\n    }\n}\n"]}