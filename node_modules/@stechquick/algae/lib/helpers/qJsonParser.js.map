{"version":3,"file":"qJsonParser.js","sourceRoot":"","sources":["../../src/helpers/qJsonParser.ts"],"names":[],"mappings":";;;AAAA;IAAA;IAgDA,CAAC;IA/CU,wCAAkB,GAAzB,UAA0B,SAAqC;QAC3D,IAAI,OAAO,SAAS,IAAI,QAAQ,EAAE;YAC9B,OAAO,SAAS,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,SAAS,CAAC;SACvF;aAAM;YACH,IAAM,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;YAC9C,OAAO,SAAS,CAAC,KAAK,IAAI,WAAW,CAAC;SACzC;IACL,CAAC;IAEM,uCAAiB,GAAxB,UAAyB,UAAkB;QACvC,IAAI,IAAI,GAAW,UAAU,CAAC;QAC9B,IAAI,UAAU,CAAC,OAAO,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC,EAAE;YACxC,IAAI,YAAY,GAAG,UAAU,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC;YACnD,YAAY,GAAG,YAAY,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC;YAC1E,IAAI,GAAG,YAAY,CAAC,CAAC,CAAC,CAAC;SAC1B;aAAM,IAAI,IAAI,CAAC,OAAO,CAAC,eAAe,CAAC,GAAG,CAAC,CAAC,EAAE;YAC3C,IAAM,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC;YACpD,IAAM,cAAc,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE,aAAa,CAAC,GAAG,CAAC,CAAC;YAE5D,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,cAAc,EAAE,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;SAC1D;QAED,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;IAC5B,CAAC;IAEO,yCAAmB,GAA3B,UAA4B,UAAkB;QAC1C,IAAI,WAAW,GAAG,mDAAmD,CAAC;QACtE,IAAI,KAAK,GAAG,IAAI,MAAM,CAAC,MAAI,WAAW,OAAI,EAAE,IAAI,CAAC,CAAC;QAClD,IAAI,UAAU,GAAG,UAAU,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QACzC,UAAU,aAAV,UAAU,uBAAV,UAAU,CAAE,OAAO,CAAC;YAChB,IAAI,UAAU,GAAG,UAAU,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;YACjD,IAAI,QAAQ,GAAG,UAAU,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;YAC7D,UAAU,GAAG,UAAU,CAAC,SAAS,CAAC,CAAC,EAAE,UAAU,CAAC,GAAG,UAAU,CAAC,SAAS,CAAC,UAAU,GAAG,QAAQ,CAAC,CAAC;QACnG,CAAC,CAAC,CAAA;QACF,OAAO,UAAU,CAAC;IACtB,CAAC;IAEM,iCAAW,GAAlB,UAAmB,QAAgB,EAAE,oBAA6B;QAC9D,IAAI,UAAU,GAAG,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,CAAC;QACnD,IAAI,CAAC,oBAAoB,EAAE;YACvB,UAAU,GAAG,IAAI,CAAC,mBAAmB,CAAC,UAAU,CAAC,CAAC;SACrD;QACD,IAAI,KAAK,GAAG,IAAI,CAAC,iBAAiB,CAAC,UAAU,CAAC,CAAC;QACxC,KAAK,aAAL,KAAK,4BAAL,KAAK,CAAE,KAAK,CAAC;QACb,KAAK,aAAL,KAAK,4BAAL,KAAK,CAAE,KAAK,CAAC;QACpB,OAAO,cAAc,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,yBAAyB,CAAC;IAC9E,CAAC;IACL,kBAAC;AAAD,CAAC,AAhDD,IAgDC;AAhDY,kCAAW","sourcesContent":["export class QJsonParser {\n    public qJsonMediumDecider(qjsonData: string | { qjson: string }) {\n        if (typeof qjsonData == \"string\") {\n            return qjsonData.startsWith('{\"qjson\":\"') ? JSON.parse(qjsonData).qjson : qjsonData;\n        } else {\n            const qjsonString = JSON.stringify(qjsonData);\n            return qjsonData.qjson || qjsonString;\n        }\n    }\n\n    public parseQJsonContent(jsonString: string) {\n        let json: string = jsonString;\n        if (jsonString.indexOf(\"let pjson =\") > -1) {\n            let jsonSplitted = jsonString.split(\"let pjson =\");\n            jsonSplitted = jsonSplitted[1].split(';\\nexport')[0].split(';\\r\\nexport');\n            json = jsonSplitted[0];\n        } else if (json.indexOf(\"rally_microUI\") > -1) {\n            const registerIndex = json.indexOf(\"registerQJson\");\n            const jsonStartIndex = json.indexOf(\",\", registerIndex) + 1;\n\n            json = json.substring(jsonStartIndex, json.length - 2);\n        }\n\n        return JSON.parse(json);\n    }\n\n    private deleteSourceMapping(jsonString: string) {\n        let searchValue = '//# sourceMappingURL=data:application/json;base64';\n        let regex = new RegExp(`(${searchValue}+)`, 'gi');\n        let regexCount = jsonString.match(regex);\n        regexCount?.forEach(() => {\n            let indexStart = jsonString.indexOf(searchValue);\n            let indexEnd = jsonString.substring(indexStart).indexOf('\"');\n            jsonString = jsonString.substring(0, indexStart) + jsonString.substring(indexStart + indexEnd);\n        })\n        return jsonString;\n    }\n\n    public minifyQjson(jsonBody: string, keepSourceMappingURL: boolean) {\n        let jsonString = this.qJsonMediumDecider(jsonBody);\n        if (!keepSourceMappingURL) {\n            jsonString = this.deleteSourceMapping(jsonString);\n        }\n        let qjson = this.parseQJsonContent(jsonString);\n        delete qjson?.pJson;\n        delete qjson?.lrids;\n        return \"let pjson = \" + JSON.stringify(qjson) + \";\\nexport default pjson\";\n    }\n}"]}