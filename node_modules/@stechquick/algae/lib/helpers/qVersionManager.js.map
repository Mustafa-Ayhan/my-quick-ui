{"version":3,"file":"qVersionManager.js","sourceRoot":"","sources":["../../src/helpers/qVersionManager.ts"],"names":[],"mappings":"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","sourcesContent":["import { ArrayHelper } from \"./arrayHelper\";\n\ntype VersionLengthType = 1 | 2 | 3 | 4;\n\ninterface IQVersionData {\n    numPart: number;\n    data: string\n}\n\ninterface IQVersion {\n    major: IQVersionData;\n    minor: IQVersionData;\n    revision: IQVersionData;\n    build: IQVersionData;\n    length: VersionLengthType;\n}\n\nexport interface IncrementQVersionOptions {\n    major?: number;\n    minor?: number;\n    build?: number;\n    revision?: number;\n    resetSubLevels?: boolean;\n}\n\nexport class QVersionManager {\n    private numChars: Record<string, boolean>;\n\n    constructor() {\n        this.numChars = { \"1\": true, \"2\": true, \"3\": true, \"4\": true, \"5\": true, \"6\": true, \"7\": true, \"8\": true, \"9\": true, \"0\": true };\n    }\n\n    private extractPrependNumber(data: string): IQVersionData {\n        let bucket = \"\";\n        let curData;\n        var i = 0;\n        for (i = 0; i < data.length; i++) {\n            curData = data[i];\n            if (this.numChars[curData]) {\n                bucket += curData;\n            } else {\n                break;\n            }\n        }\n        return { numPart: Number(bucket), data: data.substring(i) };\n    }\n\n    private getBigger(length1: VersionLengthType, length2: VersionLengthType) {\n        return length1 > length2 ? length1 : length2;\n    }\n\n    private Add(versionData: IQVersionData, versionData2: IQVersionData): IQVersionData {\n        return { data: versionData.data + versionData2.data, numPart: versionData.numPart + versionData2.numPart };\n    }\n\n    public ParseVersion(version: string): IQVersion {\n        const strings = version.split(\".\");\n        const datas: Array<IQVersionData> = [];\n        let curData: IQVersionData;\n        for (var i = 0; i < 4; i++) {\n            curData = strings.length > i ? this.extractPrependNumber(strings[i]) : { data: \"\", numPart: 0 };\n            datas[i] = curData;\n        }\n        const ver: IQVersion = { major: datas[0], minor: datas[1], build: datas[2], revision: datas[3], length: strings.length as VersionLengthType };\n        return ver;\n    }\n\n    public AddVersion(version: IQVersion, increment: IQVersion): IQVersion {\n        return {\n            major: this.Add(version.major, increment.major),\n            minor: this.Add(version.minor, increment.minor),\n            revision: this.Add(version.revision, increment.revision),\n            build: this.Add(version.build, increment.build),\n            length: this.getBigger(version.length, increment.length),\n        };\n    }\n\n    public IncrementAsQVersion(version: IQVersion, options: IncrementQVersionOptions): IQVersion {\n        const majorNumPart = options.major ? version.major.numPart + options.major : version.major.numPart;\n        let minorNumPart = version.minor.numPart;\n        let buildNumPart = version.build.numPart;\n        let revisionNumPart = version.revision.numPart;\n\n        if(!options.minor && !options.build && !options.revision && options.resetSubLevels == true){\n            minorNumPart = 0;\n        }\n        else if(options.minor){\n            minorNumPart = minorNumPart + options.minor;\n        }\n\n        if(!options.build && !options.revision && options.resetSubLevels == true){\n            buildNumPart = 0;\n        }\n        else if(options.build){\n            buildNumPart = buildNumPart + options.build;\n        }\n\n        if(!options.revision && options.resetSubLevels == true){\n            revisionNumPart = 0;\n        }\n        else if(options.revision){\n            revisionNumPart = revisionNumPart + options.revision;\n        }\n\n        return {\n            major: { data: version.major.data, numPart: majorNumPart },\n            minor: { data: version.minor.data, numPart: minorNumPart },\n            build: { data: version.build.data, numPart: buildNumPart },\n            revision: { data: version.revision.data, numPart: revisionNumPart },\n            length: this.getBigger(version.length, options.revision ? 4 : options.build ? 3 : options.minor ? 2 : options.major ? 1 : 1),\n        }\n    }\n\n    public ToString(version: IQVersion) {\n        const keys = [\"major\", \"minor\", \"build\", \"revision\"];\n        const v = version as unknown as Record<string, IQVersionData>;\n        const arr = ArrayHelper.InitEmptyArray(version.length);\n\n        for (var i = 0; i < version.length; i++) {\n            const data = v[keys[i]];\n            arr[i] = data.numPart + data.data;\n        }\n\n        return arr.join(\".\");\n    }\n\n    public IncrementAsString(version: string, options: IncrementQVersionOptions): string {\n        const parsedValue = this.ParseVersion(version);\n        const incrementedValue = this.IncrementAsQVersion(parsedValue, options);\n        const result = this.ToString(incrementedValue);\n        return result;\n    }\n\n    //console.log(ToString(Increment(ParseVersion(\"5.1\"), { major: 0, minor: 2})));\n\n}"]}