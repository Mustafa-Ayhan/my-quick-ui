{"version":3,"file":"windowHelper.js","sourceRoot":"","sources":["../../src/helpers/windowHelper.ts"],"names":[],"mappings":";;;AAAA,mCAA2C;AAC3C,+CAA8C;AAE9C,IAAM,aAAa,GAAW,WAAW,CAAC;AA2B1C;IAQI;QACI,IAAI,CAAC,GAAG,GAAG,OAAO,CAAC,QAAQ,CAAC,KAAK,aAAa,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;YACxD,gBAAgB,EAAhB,UAAiB,IAAY,EAAE,QAA4C,EAAE,OAA2C;gBACpH,kCAAkC;gBAClC,eAAM,CAAC,GAAG,CAAC,EAAE,UAAU,EAAE,8FAA4F,IAAM,EAAE,OAAO,EAAE,gBAAO,CAAC,OAAO,EAAE,CAAC,CAAC;gBACzI,QAAS,CAAM,EAAE,MAAM,EAAE,EAAE,UAAU,EAAE,IAAI,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC;YAChF,CAAC;YACD,aAAa,EAAb,UAAc,OAAe,EAAE,OAAgC;gBAC3D,OAAY,EAAE,OAAO,SAAA,EAAE,OAAO,SAAA,EAAE,CAAC;YACrC,CAAC;YACD,UAAU,EAAE,UAAU;SACzB,CAAC;QAEF,IAAI,CAAC,IAAI,GAAG,OAAO,CAAC,OAAO,CAAC,KAAK,aAAa,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;YACvD,SAAS,EAAT,UAAU,IAAS,EAAE,KAAa,EAAE,GAAmB;gBACnD,wDAAwD;gBACxD,eAAM,CAAC,GAAG,CAAC,EAAE,UAAU,EAAE,qDAAmD,KAAO,EAAE,OAAO,EAAE,gBAAO,CAAC,KAAK,EAAE,CAAC,CAAC;YACnH,CAAC;SACJ,CAAC;QAEF,IAAI,CAAC,GAAG,GAAG,OAAO,CAAC,MAAM,CAAC,KAAK,aAAa,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;YACpD,WAAW,EAAE,WAAW;YACxB,aAAa,EAAE,aAAa;YAC5B,UAAU,EAAE,UAAU;YACtB,YAAY,EAAE,YAAY;YAC1B,IAAI,EAAE,IAAI;YACV,IAAI,EAAE,IAAI;SACb,CAAC;QAEF,IAAI,CAAC,YAAY,GAAG;YAChB,MAAM,EAAN,UAAO,SAAiB,EAAE,OAAmC;gBACzD,OAAO,OAAO,CAAC,MAAM,CAAC,KAAK,aAAa,CAAC,CAAC,CAAC,IAAI,MAAM,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC;YAC1F,CAAC;SACJ,CAAA;QAED,mDAAmD;IACvD,CAAC;IACD,sBAAW,oCAAU;aAArB,UAAsB,KAA0C;YAC5D,IAAI,OAAO,CAAC,MAAM,CAAC,KAAK,aAAa,EAAE;gBACnC,MAAM,CAAC,UAAU,GAAG,KAAK,CAAA;aAC5B;iBAAM;gBACH,eAAM,CAAC,GAAG,CAAC,EAAE,UAAU,EAAE,mCAAmC,EAAE,OAAO,EAAE,gBAAO,CAAC,KAAK,EAAE,CAAC,CAAC;aAC3F;QACL,CAAC;;;OAAA;IACD,sBAAW,kCAAQ;aAAnB;YACI,OAAO,IAAI,CAAC,GAAG,CAAC;QACpB,CAAC;;;OAAA;IACD,sBAAW,iCAAO;aAAlB;YACI,OAAO,IAAI,CAAC,IAAI,CAAC;QACrB,CAAC;;;OAAA;IACD,sBAAW,gCAAM;aAAjB;YACI,OAAO,IAAI,CAAC,GAAG,CAAC;QACpB,CAAC;;;OAAA;IACD,sBAAW,gCAAM;aAAjB;YACI,OAAO,IAAI,CAAC,YAAY,CAAC;QAC7B,CAAC;;;OAAA;IACa,qBAAQ,GAAiB,2BAAY,CAAC,cAAc,CAAC,cAAc,EAAE,IAAI,YAAY,EAAE,CAAC,MAAM,EAAE,IAAI,YAAY,EAAE,CAAC,CAAC;IAEtI,mBAAC;CAAA,AAlED,IAkEC;AAlEY,oCAAY","sourcesContent":["import { Logger, LogType } from \"./logger\";\nimport { Singularizer } from \"./singularizer\";\n\nconst undefinedType: string = \"undefined\";\n\ninterface EventListenerCollection {\n    origAddEventListener: any,\n    origRemoveEventListener: any,\n\n    eventTarget: any\n}\n\nexport interface IDocument extends Partial<Document> {\n    addEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: boolean | AddEventListenerOptions): void;\n    createElement(tagName: string, options?: ElementCreationOptions): HTMLElement;\n}\n\nexport interface IHistory extends Partial<History> {\n    pushState(data: any, title: string, url?: string | null): void;\n}\n\n\nexport interface IWindow extends Partial<Window> {\n\n}\nexport interface IWorker {\n    worker(scriptURL: string | URL, options?: WorkerOptions | undefined): Worker | undefined\n\n}\n\nexport class WindowHelper {\n\n    private doc: IDocument;\n    private hist: IHistory;\n    private win: IWindow;\n    private helperWorker?: IWorker;\n\n\n    constructor() {\n        this.doc = typeof (document) !== undefinedType ? document : {\n            addEventListener(type: string, listener: EventListenerOrEventListenerObject, options?: boolean | AddEventListenerOptions) {\n                //might simulate this in future...\n                Logger.Log({ logMessage: `Enviroment does not support document. Triggering document.addEventListener now, type is: ${type}`, logType: LogType.Warning });\n                (<EventListener>listener)(<any>{ target: { readyState: this.readyState } });\n            },\n            createElement(tagName: string, options?: ElementCreationOptions): HTMLElement {\n                return <any>{ tagName, options };\n            },\n            readyState: \"complete\"\n        };\n\n        this.hist = typeof (history) !== undefinedType ? history : {\n            pushState(data: any, title: string, url?: string | null) {\n                //might log data and url with additional data in logging\n                Logger.Log({ logMessage: `history.pushState not supported on Node. title: ${title}`, logType: LogType.Debug });\n            }\n        };\n\n        this.win = typeof (window) !== undefinedType ? window : {\n            setInterval: setInterval,\n            clearInterval: clearInterval,\n            setTimeout: setTimeout,\n            clearTimeout: clearTimeout,\n            atob: atob,\n            btoa: btoa\n        };\n\n        this.helperWorker = {\n            worker(scriptURL: string, options?: WorkerOptions | undefined) {\n                return typeof (Worker) !== undefinedType ? new Worker(scriptURL, options) : undefined;\n            }\n        }\n\n        // this.eventListeners = this.wrapEventListeners();\n    }\n    public set onPopState(value: ((ev: PopStateEvent) => any) | null) {\n        if (typeof (window) !== undefinedType) {\n            window.onpopstate = value\n        } else {\n            Logger.Log({ logMessage: \"onPopState not supported on Node.\", logType: LogType.Debug });\n        }\n    }\n    public get document() {\n        return this.doc;\n    }\n    public get history() {\n        return this.hist;\n    }\n    public get Window() {\n        return this.win;\n    }\n    public get Worker() {\n        return this.helperWorker;\n    }\n    public static Instance: WindowHelper = Singularizer.trySingularize(\"theOneWindow\", new WindowHelper().Window, new WindowHelper());\n\n}"]}