"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var fs_1 = __importDefault(require("fs"));
var https_1 = __importDefault(require("https"));
var CaHelper = /** @class */ (function () {
    function CaHelper() {
    }
    CaHelper.getAllFiles = function (dir) {
        if (!fs_1.default.existsSync(dir)) {
            return undefined;
        }
        ;
        var files = fs_1.default.readdirSync(dir);
        if (!files)
            return undefined;
        var certList = [];
        files.forEach(function (file) {
            var fileExtention = file.split(".").pop();
            var name = dir + '/' + file;
            if (!fileExtention || !CaHelper.certificateExtentions[fileExtention]) {
                certList.push({ isValid: false, name: name });
                return;
            }
            certList.push({ name: name, content: fs_1.default.readFileSync(name, { encoding: "utf-8" }), isValid: true });
        });
        return (certList.length == 0) ? undefined : certList;
    };
    CaHelper.registerCaCerts = function (caCerts) {
        if (caCerts.length == 0) {
            return;
        }
        ;
        https_1.default.globalAgent.options.ca = https_1.default.globalAgent.options.ca || [];
        if (!(https_1.default.globalAgent.options.ca instanceof Array)) {
            https_1.default.globalAgent.options.ca = [https_1.default.globalAgent.options.ca];
        }
        var certificateList = https_1.default.globalAgent.options.ca;
        caCerts === null || caCerts === void 0 ? void 0 : caCerts.forEach(function (caCert) { return certificateList.push(caCert); });
    };
    CaHelper.certificateExtentions = { "crt": true, "crl": true, "csr": true, "der": true, "cer": true, "ca-bundle": true, "p7b": true, "p7c": true, "p7s": true, "pem": true, "arm": true, "pfx": true, };
    return CaHelper;
}());
exports.default = CaHelper;
//# sourceMappingURL=searchRootCa.js.map